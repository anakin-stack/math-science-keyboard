{"ast":null,"code":"\"use strict\";\n\nconst {\n  CookieJar\n} = require(\"tough-cookie\");\nconst NodeImpl = require(\"./Node-impl\").implementation;\nconst NODE_TYPE = require(\"../node-type\");\nconst {\n  mixin,\n  memoizeQuery\n} = require(\"../../utils\");\nconst {\n  firstChildWithHTMLLocalName,\n  firstChildWithHTMLLocalNames,\n  firstDescendantWithHTMLLocalName\n} = require(\"../helpers/traversal\");\nconst whatwgURL = require(\"whatwg-url\");\nconst {\n  StyleSheetList\n} = require(\"../../level2/style\");\nconst {\n  domSymbolTree\n} = require(\"../helpers/internal-constants\");\nconst eventAccessors = require(\"../helpers/create-event-accessor\");\nconst {\n  asciiLowercase,\n  stripAndCollapseASCIIWhitespace\n} = require(\"../helpers/strings\");\nconst {\n  HTML_NS,\n  SVG_NS\n} = require(\"../helpers/namespaces\");\nconst DOMException = require(\"domexception\");\nconst HTMLToDOM = require(\"../../browser/htmltodom\");\nconst History = require(\"../generated/History\");\nconst Location = require(\"../generated/Location\");\nconst HTMLCollection = require(\"../generated/HTMLCollection\");\nconst NodeList = require(\"../generated/NodeList\");\nconst validateName = require(\"../helpers/validate-names\").name;\nconst {\n  validateAndExtract\n} = require(\"../helpers/validate-names\");\nconst resourceLoader = require(\"../../browser/resource-loader\");\nconst GlobalEventHandlersImpl = require(\"./GlobalEventHandlers-impl\").implementation;\nconst {\n  clone,\n  listOfElementsWithQualifiedName,\n  listOfElementsWithNamespaceAndLocalName,\n  listOfElementsWithClassNames\n} = require(\"../node\");\nconst generatedAttr = require(\"../generated/Attr\");\nconst Comment = require(\"../generated/Comment\");\nconst ProcessingInstruction = require(\"../generated/ProcessingInstruction\");\nconst CDATASection = require(\"../generated/CDATASection\");\nconst Text = require(\"../generated/Text\");\nconst DocumentFragment = require(\"../generated/DocumentFragment\");\nconst DOMImplementation = require(\"../generated/DOMImplementation\");\nconst NonElementParentNodeImpl = require(\"./NonElementParentNode-impl\").implementation;\nconst ParentNodeImpl = require(\"./ParentNode-impl\").implementation;\nconst Element = require(\"../generated/Element\");\nconst HTMLUnknownElement = require(\"../generated/HTMLUnknownElement\");\nconst SVGElement = require(\"../generated/SVGElement\");\nconst TreeWalker = require(\"../generated/TreeWalker\");\nconst NodeIterator = require(\"../generated/NodeIterator\");\nconst CustomEvent = require(\"../generated/CustomEvent\");\nconst ErrorEvent = require(\"../generated/ErrorEvent\");\nconst Event = require(\"../generated/Event\");\nconst FocusEvent = require(\"../generated/FocusEvent\");\nconst HashChangeEvent = require(\"../generated/HashChangeEvent\");\nconst KeyboardEvent = require(\"../generated/KeyboardEvent\");\nconst MessageEvent = require(\"../generated/MessageEvent\");\nconst MouseEvent = require(\"../generated/MouseEvent\");\nconst PopStateEvent = require(\"../generated/PopStateEvent\");\nconst ProgressEvent = require(\"../generated/ProgressEvent\");\nconst TouchEvent = require(\"../generated/TouchEvent\");\nconst UIEvent = require(\"../generated/UIEvent\");\nfunction clearChildNodes(node) {\n  for (let child = domSymbolTree.firstChild(node); child; child = domSymbolTree.firstChild(node)) {\n    node.removeChild(child);\n  }\n}\nclass ResourceQueue {\n  constructor(paused) {\n    this.paused = Boolean(paused);\n  }\n  push(callback) {\n    const q = this;\n    const item = {\n      prev: q.tail,\n      check() {\n        if (!q.paused && !this.prev && this.fired) {\n          callback(this.err, this.data, this.response);\n          if (this.next) {\n            this.next.prev = null;\n            this.next.check();\n          } else {\n            // q.tail===this\n            q.tail = null;\n          }\n        }\n      }\n    };\n    if (q.tail) {\n      q.tail.next = item;\n    }\n    q.tail = item;\n    return (err, data, response) => {\n      item.fired = 1;\n      item.err = err;\n      item.data = data;\n      item.response = response;\n      item.check();\n    };\n  }\n  resume() {\n    if (!this.paused) {\n      return;\n    }\n    this.paused = false;\n    let head = this.tail;\n    while (head && head.prev) {\n      head = head.prev;\n    }\n    if (head) {\n      head.check();\n    }\n  }\n}\nclass RequestManager {\n  constructor() {\n    this.openedRequests = [];\n  }\n  add(req) {\n    this.openedRequests.push(req);\n  }\n  remove(req) {\n    const idx = this.openedRequests.indexOf(req);\n    if (idx !== -1) {\n      this.openedRequests.splice(idx, 1);\n    }\n  }\n  close() {\n    for (const openedRequest of this.openedRequests) {\n      openedRequest.abort();\n    }\n    this.openedRequests = [];\n  }\n  size() {\n    return this.openedRequests.length;\n  }\n}\nfunction pad(number) {\n  if (number < 10) {\n    return \"0\" + number;\n  }\n  return number;\n}\nfunction toLastModifiedString(date) {\n  return pad(date.getMonth() + 1) + \"/\" + pad(date.getDate()) + \"/\" + date.getFullYear() + \" \" + pad(date.getHours()) + \":\" + pad(date.getMinutes()) + \":\" + pad(date.getSeconds());\n}\nconst eventInterfaceTable = {\n  customevent: CustomEvent,\n  errorevent: ErrorEvent,\n  event: Event,\n  events: Event,\n  focusevent: FocusEvent,\n  hashchangeevent: HashChangeEvent,\n  htmlevents: Event,\n  keyboardevent: KeyboardEvent,\n  messageevent: MessageEvent,\n  mouseevent: MouseEvent,\n  mouseevents: MouseEvent,\n  popstateevent: PopStateEvent,\n  progressevent: ProgressEvent,\n  svgevents: Event,\n  touchevent: TouchEvent,\n  uievent: UIEvent,\n  uievents: UIEvent\n};\nclass DocumentImpl extends NodeImpl {\n  constructor(args, privateData) {\n    super(args, privateData);\n    this._initGlobalEvents();\n    this._ownerDocument = this;\n    this.nodeType = NODE_TYPE.DOCUMENT_NODE;\n    if (!privateData.options) {\n      privateData.options = {};\n    }\n    if (!privateData.options.parsingMode) {\n      privateData.options.parsingMode = \"xml\";\n    }\n    if (!privateData.options.encoding) {\n      privateData.options.encoding = \"UTF-8\";\n    }\n    if (!privateData.options.contentType) {\n      privateData.options.contentType = privateData.options.parsingMode === \"xml\" ? \"application/xml\" : \"text/html\";\n    }\n    this._parsingMode = privateData.options.parsingMode;\n    this._htmlToDom = new HTMLToDOM(privateData.options.parsingMode);\n    this._implementation = DOMImplementation.createImpl([], {\n      ownerDocument: this\n    });\n    this._defaultView = privateData.options.defaultView || null;\n    this._global = privateData.options.global;\n    this._documentElement = null;\n    this._ids = Object.create(null);\n    this._attached = true;\n    this._currentScript = null;\n    this._cookieJar = privateData.options.cookieJar;\n    this._parseOptions = privateData.options.parseOptions;\n    if (this._cookieJar === undefined) {\n      this._cookieJar = new CookieJar(null, {\n        looseMode: true\n      });\n    }\n    this.contentType = privateData.options.contentType;\n    this._encoding = privateData.options.encoding;\n    const urlOption = privateData.options.url === undefined ? \"about:blank\" : privateData.options.url;\n    const parsed = whatwgURL.parseURL(urlOption);\n    if (parsed === null) {\n      throw new TypeError(`Could not parse \"${urlOption}\" as a URL`);\n    }\n    this._URL = parsed;\n    this.origin = whatwgURL.serializeURLOrigin(parsed);\n    this._location = Location.createImpl([], {\n      relevantDocument: this\n    });\n    this._history = History.createImpl([], {\n      window: this._defaultView,\n      document: this,\n      actAsIfLocationReloadCalled: () => this._location.reload()\n    });\n    if (privateData.options.cookie) {\n      const cookies = Array.isArray(privateData.options.cookie) ? privateData.options.cookie : [privateData.options.cookie];\n      const document = this;\n      cookies.forEach(cookieStr => {\n        document._cookieJar.setCookieSync(cookieStr, document.URL, {\n          ignoreError: true\n        });\n      });\n    }\n    this._workingNodeIterators = [];\n    this._workingNodeIteratorsMax = privateData.options.concurrentNodeIterators === undefined ? 10 : Number(privateData.options.concurrentNodeIterators);\n    if (isNaN(this._workingNodeIteratorsMax)) {\n      throw new TypeError(\"The 'concurrentNodeIterators' option must be a Number\");\n    }\n    if (this._workingNodeIteratorsMax < 0) {\n      throw new RangeError(\"The 'concurrentNodeIterators' option must be a non negative Number\");\n    }\n    this._referrer = privateData.options.referrer || \"\";\n    this._lastModified = toLastModifiedString(privateData.options.lastModified || new Date());\n    this._queue = new ResourceQueue(privateData.options.deferClose);\n    this._customResourceLoader = privateData.options.resourceLoader;\n    this._pool = privateData.options.pool;\n    this._agentOptions = privateData.options.agentOptions;\n    this._strictSSL = privateData.options.strictSSL;\n    this._proxy = privateData.options.proxy;\n    this._requestManager = new RequestManager();\n    this.readyState = \"loading\";\n    this._lastFocusedElement = null;\n\n    // Each Document in a browsing context can also have a latest entry. This is the entry for that Document\n    // to which the browsing context's session history was most recently traversed. When a Document is created,\n    // it initially has no latest entry.\n    this._latestEntry = null;\n  }\n  get compatMode() {\n    return this._parsingMode === \"xml\" || this.doctype ? \"CSS1Compat\" : \"BackCompat\";\n  }\n  get charset() {\n    return this._encoding;\n  }\n  get characterSet() {\n    return this._encoding;\n  }\n  get inputEncoding() {\n    return this._encoding;\n  }\n  get doctype() {\n    for (const childNode of domSymbolTree.childrenIterator(this)) {\n      if (childNode.nodeType === NODE_TYPE.DOCUMENT_TYPE_NODE) {\n        return childNode;\n      }\n    }\n    return null;\n  }\n  get URL() {\n    return whatwgURL.serializeURL(this._URL);\n  }\n  get documentURI() {\n    return whatwgURL.serializeURL(this._URL);\n  }\n  get location() {\n    return this._defaultView ? this._location : null;\n  }\n  get documentElement() {\n    if (this._documentElement) {\n      return this._documentElement;\n    }\n    for (const childNode of domSymbolTree.childrenIterator(this)) {\n      if (childNode.nodeType === NODE_TYPE.ELEMENT_NODE) {\n        this._documentElement = childNode;\n        return childNode;\n      }\n    }\n    return null;\n  }\n  get implementation() {\n    return this._implementation;\n  }\n  set implementation(implementation) {\n    this._implementation = implementation;\n  }\n  get defaultView() {\n    return this._defaultView;\n  }\n  get currentScript() {\n    return this._currentScript;\n  }\n  get activeElement() {\n    if (this._lastFocusedElement) {\n      return this._lastFocusedElement;\n    }\n    return this.body;\n  }\n  hasFocus() {\n    return Boolean(this._lastFocusedElement);\n  }\n  _createElementWithCorrectElementInterface(localName, namespace) {\n    // https://dom.spec.whatwg.org/#concept-element-interface\n\n    if (this._elementBuilders[namespace] && this._elementBuilders[namespace][localName]) {\n      return this._elementBuilders[namespace][localName](this, localName, namespace);\n    } else if (namespace === HTML_NS) {\n      return HTMLUnknownElement.createImpl([], {\n        ownerDocument: this,\n        localName,\n        namespace\n      });\n    } else if (namespace === SVG_NS) {\n      return SVGElement.createImpl([], {\n        ownerDocument: this,\n        localName,\n        namespace\n      });\n    }\n    return Element.createImpl([], {\n      ownerDocument: this,\n      localName,\n      namespace\n    });\n  }\n  appendChild( /* Node */arg) {\n    if (this.documentElement && arg.nodeType === NODE_TYPE.ELEMENT_NODE) {\n      throw new DOMException(\"The operation would yield an incorrect node tree.\", \"HierarchyRequestError\");\n    }\n    return super.appendChild(arg);\n  }\n  removeChild( /* Node */arg) {\n    const ret = super.removeChild(arg);\n    if (arg === this._documentElement) {\n      this._documentElement = null; // force a recalculation\n    }\n\n    return ret;\n  }\n  _descendantRemoved(parent, child) {\n    if (child.tagName === \"STYLE\") {\n      const index = this.styleSheets.indexOf(child.sheet);\n      if (index > -1) {\n        this.styleSheets.splice(index, 1);\n      }\n    }\n  }\n  write() {\n    let text = \"\";\n    for (let i = 0; i < arguments.length; ++i) {\n      text += String(arguments[i]);\n    }\n    if (this._parsingMode === \"xml\") {\n      throw new DOMException(\"Cannot use document.write on XML documents\", \"InvalidStateError\");\n    }\n    if (this._writeAfterElement) {\n      // If called from an script element directly (during the first tick),\n      // the new elements are inserted right after that element.\n      const tempDiv = this.createElement(\"div\");\n      tempDiv.innerHTML = text;\n      let child = tempDiv.firstChild;\n      let previous = this._writeAfterElement;\n      const parent = this._writeAfterElement.parentNode;\n      while (child) {\n        const node = child;\n        child = child.nextSibling;\n        node._isMovingDueToDocumentWrite = true; // hack for script execution\n        parent.insertBefore(node, previous.nextSibling);\n        node._isMovingDueToDocumentWrite = false;\n        previous = node;\n      }\n    } else if (this.readyState === \"loading\") {\n      // During page loading, document.write appends to the current element\n      // Find the last child that has been added to the document.\n      if (this.lastChild) {\n        let node = this;\n        while (node.lastChild && node.lastChild.nodeType === NODE_TYPE.ELEMENT_NODE) {\n          node = node.lastChild;\n        }\n        node.innerHTML = text;\n      } else {\n        clearChildNodes(this);\n        this._htmlToDom.appendToDocument(text, this);\n      }\n    } else if (text) {\n      clearChildNodes(this);\n      this._htmlToDom.appendToDocument(text, this);\n    }\n  }\n  writeln() {\n    this.write(...arguments, \"\\n\");\n  }\n\n  // This is implemented separately for Document (which has a _ids cache) and DocumentFragment (which does not).\n  getElementById(id) {\n    // Return the first element with this ID.\n    return this._ids[id] && this._ids[id].length > 0 ? this._ids[id][0] : null;\n  }\n  get referrer() {\n    return this._referrer || \"\";\n  }\n  get lastModified() {\n    return this._lastModified;\n  }\n  get images() {\n    return this.getElementsByTagName(\"IMG\");\n  }\n  get embeds() {\n    return this.getElementsByTagName(\"EMBED\");\n  }\n  get plugins() {\n    return this.embeds;\n  }\n  get links() {\n    return HTMLCollection.createImpl([], {\n      element: this,\n      query: () => domSymbolTree.treeToArray(this, {\n        filter: node => (node._localName === \"a\" || node._localName === \"area\") && node.hasAttribute(\"href\") && node._namespaceURI === HTML_NS\n      })\n    });\n  }\n  get forms() {\n    return this.getElementsByTagName(\"FORM\");\n  }\n  get scripts() {\n    return this.getElementsByTagName(\"SCRIPT\");\n  }\n  get anchors() {\n    return HTMLCollection.createImpl([], {\n      element: this,\n      query: () => domSymbolTree.treeToArray(this, {\n        filter: node => node._localName === \"a\" && node.hasAttribute(\"name\") && node._namespaceURI === HTML_NS\n      })\n    });\n  }\n\n  // The applets attribute must return an\n  // HTMLCollection rooted at the Document node,\n  // whose filter matches nothing.\n  // (It exists for historical reasons.)\n  get applets() {\n    return HTMLCollection.createImpl([], {\n      element: this,\n      query: () => []\n    });\n  }\n  open() {\n    let child = domSymbolTree.firstChild(this);\n    while (child) {\n      this.removeChild(child);\n      child = domSymbolTree.firstChild(this);\n    }\n    this._documentElement = null;\n    this._modified();\n    return this;\n  }\n  close() {\n    this._queue.resume();\n\n    // Set the readyState to 'complete' once all resources are loaded.\n    // As a side-effect the document's load-event will be dispatched.\n    resourceLoader.enqueue(this, null, function () {\n      this.readyState = \"complete\";\n      const ev = this.createEvent(\"HTMLEvents\");\n      ev.initEvent(\"DOMContentLoaded\", false, false);\n      this.dispatchEvent(ev);\n    })(null, true);\n  }\n  getElementsByName(elementName) {\n    return NodeList.createImpl([], {\n      element: this,\n      query: () => domSymbolTree.treeToArray(this, {\n        filter: node => node.getAttribute && node.getAttribute(\"name\") === elementName\n      })\n    });\n  }\n  get title() {\n    // TODO SVG\n\n    const titleElement = firstDescendantWithHTMLLocalName(this, \"title\");\n    let value = titleElement !== null ? titleElement.textContent : \"\";\n    value = stripAndCollapseASCIIWhitespace(value);\n    return value;\n  }\n  set title(val) {\n    // TODO SVG\n\n    const titleElement = firstDescendantWithHTMLLocalName(this, \"title\");\n    const headElement = this.head;\n    if (titleElement === null && headElement === null) {\n      return;\n    }\n    let element;\n    if (titleElement !== null) {\n      element = titleElement;\n    } else {\n      element = this.createElement(\"title\");\n      headElement.appendChild(element);\n    }\n    element.textContent = val;\n  }\n  get dir() {\n    return this.documentElement ? this.documentElement.dir : \"\";\n  }\n  set dir(value) {\n    if (this.documentElement) {\n      this.documentElement.dir = value;\n    }\n  }\n  get head() {\n    return this.documentElement ? firstChildWithHTMLLocalName(this.documentElement, \"head\") : null;\n  }\n  get body() {\n    const {\n      documentElement\n    } = this;\n    if (!documentElement || documentElement._localName !== \"html\" || documentElement._namespaceURI !== HTML_NS) {\n      return null;\n    }\n    return firstChildWithHTMLLocalNames(this.documentElement, new Set([\"body\", \"frameset\"]));\n  }\n  set body(value) {\n    if (value === null || value._namespaceURI !== HTML_NS || value._localName !== \"body\" && value._localName !== \"frameset\") {\n      throw new DOMException(\"Cannot set the body to null or a non-body/frameset element\", \"HierarchyRequestError\");\n    }\n    const bodyElement = this.body;\n    if (value === bodyElement) {\n      return;\n    }\n    if (bodyElement !== null) {\n      bodyElement.parentNode.replaceChild(value, bodyElement);\n      return;\n    }\n    const {\n      documentElement\n    } = this;\n    if (documentElement === null) {\n      throw new DOMException(\"Cannot set the body when there is no document element\", \"HierarchyRequestError\");\n    }\n    documentElement.appendChild(value);\n  }\n  _runPreRemovingSteps(oldNode) {\n    for (const activeNodeIterator of this._workingNodeIterators) {\n      activeNodeIterator._preRemovingSteps(oldNode);\n    }\n  }\n  createEvent(type) {\n    const typeLower = type.toLowerCase();\n    const eventWrapper = eventInterfaceTable[typeLower] || null;\n    if (!eventWrapper) {\n      throw new DOMException(\"The provided event type (\\\"\" + type + \"\\\") is invalid\", \"NotSupportedError\");\n    }\n    const impl = eventWrapper.createImpl([\"\"]);\n    impl._initializedFlag = false;\n    return impl;\n  }\n  createProcessingInstruction(target, data) {\n    validateName(target);\n    if (data.includes(\"?>\")) {\n      throw new DOMException(\"Processing instruction data cannot contain the string \\\"?>\\\"\", \"InvalidCharacterError\");\n    }\n    return ProcessingInstruction.createImpl([], {\n      ownerDocument: this,\n      target,\n      data\n    });\n  }\n\n  // https://dom.spec.whatwg.org/#dom-document-createcdatasection\n  createCDATASection(data) {\n    if (this._parsingMode === \"html\") {\n      throw new DOMException(\"Cannot create CDATA sections in HTML documents\", \"NotSupportedError\");\n    }\n    if (data.includes(\"]]>\")) {\n      throw new DOMException(\"CDATA section data cannot contain the string \\\"]]>\\\"\", \"InvalidCharacterError\");\n    }\n    return CDATASection.createImpl([], {\n      ownerDocument: this,\n      data\n    });\n  }\n  createTextNode(data) {\n    return Text.createImpl([], {\n      ownerDocument: this,\n      data\n    });\n  }\n  createComment(data) {\n    return Comment.createImpl([], {\n      ownerDocument: this,\n      data\n    });\n  }\n  createElement(localName) {\n    validateName(localName);\n    if (this._parsingMode === \"html\") {\n      localName = asciiLowercase(localName);\n    }\n    const namespace = this._parsingMode === \"html\" || this.contentType === \"application/xhtml+xml\" ? HTML_NS : null;\n    return this._createElementWithCorrectElementInterface(localName, namespace);\n  }\n  createElementNS(namespace, qualifiedName) {\n    namespace = namespace !== null ? String(namespace) : namespace;\n    const extracted = validateAndExtract(namespace, qualifiedName);\n    const element = this._createElementWithCorrectElementInterface(extracted.localName, extracted.namespace);\n    element._prefix = extracted.prefix;\n    return element;\n  }\n  createDocumentFragment() {\n    return DocumentFragment.createImpl([], {\n      ownerDocument: this\n    });\n  }\n  createAttribute(localName) {\n    validateName(localName);\n    if (this._parsingMode === \"html\") {\n      localName = asciiLowercase(localName);\n    }\n    return generatedAttr.createImpl([], {\n      localName\n    });\n  }\n  createAttributeNS(namespace, name) {\n    if (namespace === undefined) {\n      namespace = null;\n    }\n    namespace = namespace !== null ? String(namespace) : namespace;\n    const extracted = validateAndExtract(namespace, name);\n    return generatedAttr.createImpl([], {\n      namespace: extracted.namespace,\n      namespacePrefix: extracted.prefix,\n      localName: extracted.localName\n    });\n  }\n\n  // TODO: Add callback interface support to `webidl2js`\n  createTreeWalker(root, whatToShow, filter) {\n    return TreeWalker.createImpl([], {\n      root,\n      whatToShow,\n      filter\n    });\n  }\n  createNodeIterator(root, whatToShow, filter) {\n    const nodeIterator = NodeIterator.createImpl([], {\n      root,\n      whatToShow,\n      filter\n    });\n    this._workingNodeIterators.push(nodeIterator);\n    while (this._workingNodeIterators.length > this._workingNodeIteratorsMax) {\n      const toInactivate = this._workingNodeIterators.shift();\n      toInactivate._working = false;\n    }\n    return nodeIterator;\n  }\n  importNode(node, deep) {\n    if (node.nodeType === NODE_TYPE.DOCUMENT_NODE) {\n      throw new DOMException(\"Cannot import a document node\", \"NotSupportedError\");\n    }\n    return clone(node, this, deep);\n  }\n  adoptNode(node) {\n    if (node.nodeType === NODE_TYPE.DOCUMENT_NODE) {\n      throw new DOMException(\"Cannot adopt a document node\", \"NotSupportedError\");\n    }\n    // TODO: Determine correct way to detect a shadow root\n    // See also https://github.com/w3c/webcomponents/issues/182\n\n    if (node.parentNode) {\n      node.parentNode.removeChild(node);\n    }\n    node._ownerDocument = this;\n    for (const descendant of domSymbolTree.treeIterator(node)) {\n      descendant._ownerDocument = this;\n    }\n    return node;\n  }\n  get cookie() {\n    return this._cookieJar.getCookieStringSync(this.URL, {\n      http: false\n    });\n  }\n  set cookie(cookieStr) {\n    cookieStr = String(cookieStr);\n    this._cookieJar.setCookieSync(cookieStr, this.URL, {\n      http: false,\n      ignoreError: true\n    });\n  }\n\n  // The clear(), captureEvents(), and releaseEvents() methods must do nothing\n  clear() {}\n  captureEvents() {}\n  releaseEvents() {}\n  get styleSheets() {\n    if (!this._styleSheets) {\n      this._styleSheets = new StyleSheetList();\n    }\n\n    // TODO: each style and link element should register its sheet on creation\n    // and remove it on removal.\n    return this._styleSheets;\n  }\n  get hidden() {\n    if (this._defaultView && this._defaultView._pretendToBeVisual) {\n      return false;\n    }\n    return true;\n  }\n  get visibilityState() {\n    if (this._defaultView && this._defaultView._pretendToBeVisual) {\n      return \"visible\";\n    }\n    return \"prerender\";\n  }\n}\neventAccessors.createEventAccessor(DocumentImpl.prototype, \"readystatechange\");\nmixin(DocumentImpl.prototype, GlobalEventHandlersImpl.prototype);\nmixin(DocumentImpl.prototype, NonElementParentNodeImpl.prototype);\nmixin(DocumentImpl.prototype, ParentNodeImpl.prototype);\nDocumentImpl.prototype._elementBuilders = Object.create(null);\nDocumentImpl.prototype.getElementsByTagName = memoizeQuery(function (qualifiedName) {\n  return listOfElementsWithQualifiedName(qualifiedName, this);\n});\nDocumentImpl.prototype.getElementsByTagNameNS = memoizeQuery(function (namespace, localName) {\n  return listOfElementsWithNamespaceAndLocalName(namespace, localName, this);\n});\nDocumentImpl.prototype.getElementsByClassName = memoizeQuery(function getElementsByClassName(classNames) {\n  return listOfElementsWithClassNames(classNames, this);\n});\nmodule.exports = {\n  implementation: DocumentImpl\n};","map":{"version":3,"names":["CookieJar","require","NodeImpl","implementation","NODE_TYPE","mixin","memoizeQuery","firstChildWithHTMLLocalName","firstChildWithHTMLLocalNames","firstDescendantWithHTMLLocalName","whatwgURL","StyleSheetList","domSymbolTree","eventAccessors","asciiLowercase","stripAndCollapseASCIIWhitespace","HTML_NS","SVG_NS","DOMException","HTMLToDOM","History","Location","HTMLCollection","NodeList","validateName","name","validateAndExtract","resourceLoader","GlobalEventHandlersImpl","clone","listOfElementsWithQualifiedName","listOfElementsWithNamespaceAndLocalName","listOfElementsWithClassNames","generatedAttr","Comment","ProcessingInstruction","CDATASection","Text","DocumentFragment","DOMImplementation","NonElementParentNodeImpl","ParentNodeImpl","Element","HTMLUnknownElement","SVGElement","TreeWalker","NodeIterator","CustomEvent","ErrorEvent","Event","FocusEvent","HashChangeEvent","KeyboardEvent","MessageEvent","MouseEvent","PopStateEvent","ProgressEvent","TouchEvent","UIEvent","clearChildNodes","node","child","firstChild","removeChild","ResourceQueue","constructor","paused","Boolean","push","callback","q","item","prev","tail","check","fired","err","data","response","next","resume","head","RequestManager","openedRequests","add","req","remove","idx","indexOf","splice","close","openedRequest","abort","size","length","pad","number","toLastModifiedString","date","getMonth","getDate","getFullYear","getHours","getMinutes","getSeconds","eventInterfaceTable","customevent","errorevent","event","events","focusevent","hashchangeevent","htmlevents","keyboardevent","messageevent","mouseevent","mouseevents","popstateevent","progressevent","svgevents","touchevent","uievent","uievents","DocumentImpl","args","privateData","_initGlobalEvents","_ownerDocument","nodeType","DOCUMENT_NODE","options","parsingMode","encoding","contentType","_parsingMode","_htmlToDom","_implementation","createImpl","ownerDocument","_defaultView","defaultView","_global","global","_documentElement","_ids","Object","create","_attached","_currentScript","_cookieJar","cookieJar","_parseOptions","parseOptions","undefined","looseMode","_encoding","urlOption","url","parsed","parseURL","TypeError","_URL","origin","serializeURLOrigin","_location","relevantDocument","_history","window","document","actAsIfLocationReloadCalled","reload","cookie","cookies","Array","isArray","forEach","cookieStr","setCookieSync","URL","ignoreError","_workingNodeIterators","_workingNodeIteratorsMax","concurrentNodeIterators","Number","isNaN","RangeError","_referrer","referrer","_lastModified","lastModified","Date","_queue","deferClose","_customResourceLoader","_pool","pool","_agentOptions","agentOptions","_strictSSL","strictSSL","_proxy","proxy","_requestManager","readyState","_lastFocusedElement","_latestEntry","compatMode","doctype","charset","characterSet","inputEncoding","childNode","childrenIterator","DOCUMENT_TYPE_NODE","serializeURL","documentURI","location","documentElement","ELEMENT_NODE","currentScript","activeElement","body","hasFocus","_createElementWithCorrectElementInterface","localName","namespace","_elementBuilders","appendChild","arg","ret","_descendantRemoved","parent","tagName","index","styleSheets","sheet","write","text","i","arguments","String","_writeAfterElement","tempDiv","createElement","innerHTML","previous","parentNode","nextSibling","_isMovingDueToDocumentWrite","insertBefore","lastChild","appendToDocument","writeln","getElementById","id","images","getElementsByTagName","embeds","plugins","links","element","query","treeToArray","filter","_localName","hasAttribute","_namespaceURI","forms","scripts","anchors","applets","open","_modified","enqueue","ev","createEvent","initEvent","dispatchEvent","getElementsByName","elementName","getAttribute","title","titleElement","value","textContent","val","headElement","dir","Set","bodyElement","replaceChild","_runPreRemovingSteps","oldNode","activeNodeIterator","_preRemovingSteps","type","typeLower","toLowerCase","eventWrapper","impl","_initializedFlag","createProcessingInstruction","target","includes","createCDATASection","createTextNode","createComment","createElementNS","qualifiedName","extracted","_prefix","prefix","createDocumentFragment","createAttribute","createAttributeNS","namespacePrefix","createTreeWalker","root","whatToShow","createNodeIterator","nodeIterator","toInactivate","shift","_working","importNode","deep","adoptNode","descendant","treeIterator","getCookieStringSync","http","clear","captureEvents","releaseEvents","_styleSheets","hidden","_pretendToBeVisual","visibilityState","createEventAccessor","prototype","getElementsByTagNameNS","getElementsByClassName","classNames","module","exports"],"sources":["G:/scientificKeyboard/keyboard/node_modules/mathjax-node/node_modules/jsdom/lib/jsdom/living/nodes/Document-impl.js"],"sourcesContent":["\"use strict\";\n\nconst { CookieJar } = require(\"tough-cookie\");\n\nconst NodeImpl = require(\"./Node-impl\").implementation;\n\nconst NODE_TYPE = require(\"../node-type\");\nconst { mixin, memoizeQuery } = require(\"../../utils\");\nconst { firstChildWithHTMLLocalName, firstChildWithHTMLLocalNames, firstDescendantWithHTMLLocalName } =\n  require(\"../helpers/traversal\");\nconst whatwgURL = require(\"whatwg-url\");\nconst { StyleSheetList } = require(\"../../level2/style\");\nconst { domSymbolTree } = require(\"../helpers/internal-constants\");\nconst eventAccessors = require(\"../helpers/create-event-accessor\");\nconst { asciiLowercase, stripAndCollapseASCIIWhitespace } = require(\"../helpers/strings\");\nconst { HTML_NS, SVG_NS } = require(\"../helpers/namespaces\");\nconst DOMException = require(\"domexception\");\nconst HTMLToDOM = require(\"../../browser/htmltodom\");\nconst History = require(\"../generated/History\");\nconst Location = require(\"../generated/Location\");\nconst HTMLCollection = require(\"../generated/HTMLCollection\");\nconst NodeList = require(\"../generated/NodeList\");\nconst validateName = require(\"../helpers/validate-names\").name;\nconst { validateAndExtract } = require(\"../helpers/validate-names\");\nconst resourceLoader = require(\"../../browser/resource-loader\");\n\nconst GlobalEventHandlersImpl = require(\"./GlobalEventHandlers-impl\").implementation;\n\nconst { clone, listOfElementsWithQualifiedName, listOfElementsWithNamespaceAndLocalName,\n  listOfElementsWithClassNames } = require(\"../node\");\nconst generatedAttr = require(\"../generated/Attr\");\nconst Comment = require(\"../generated/Comment\");\nconst ProcessingInstruction = require(\"../generated/ProcessingInstruction\");\nconst CDATASection = require(\"../generated/CDATASection\");\nconst Text = require(\"../generated/Text\");\nconst DocumentFragment = require(\"../generated/DocumentFragment\");\nconst DOMImplementation = require(\"../generated/DOMImplementation\");\nconst NonElementParentNodeImpl = require(\"./NonElementParentNode-impl\").implementation;\nconst ParentNodeImpl = require(\"./ParentNode-impl\").implementation;\nconst Element = require(\"../generated/Element\");\nconst HTMLUnknownElement = require(\"../generated/HTMLUnknownElement\");\nconst SVGElement = require(\"../generated/SVGElement\");\nconst TreeWalker = require(\"../generated/TreeWalker\");\nconst NodeIterator = require(\"../generated/NodeIterator\");\n\nconst CustomEvent = require(\"../generated/CustomEvent\");\nconst ErrorEvent = require(\"../generated/ErrorEvent\");\nconst Event = require(\"../generated/Event\");\nconst FocusEvent = require(\"../generated/FocusEvent\");\nconst HashChangeEvent = require(\"../generated/HashChangeEvent\");\nconst KeyboardEvent = require(\"../generated/KeyboardEvent\");\nconst MessageEvent = require(\"../generated/MessageEvent\");\nconst MouseEvent = require(\"../generated/MouseEvent\");\nconst PopStateEvent = require(\"../generated/PopStateEvent\");\nconst ProgressEvent = require(\"../generated/ProgressEvent\");\nconst TouchEvent = require(\"../generated/TouchEvent\");\nconst UIEvent = require(\"../generated/UIEvent\");\n\nfunction clearChildNodes(node) {\n  for (let child = domSymbolTree.firstChild(node); child; child = domSymbolTree.firstChild(node)) {\n    node.removeChild(child);\n  }\n}\n\nclass ResourceQueue {\n  constructor(paused) {\n    this.paused = Boolean(paused);\n  }\n\n  push(callback) {\n    const q = this;\n    const item = {\n      prev: q.tail,\n      check() {\n        if (!q.paused && !this.prev && this.fired) {\n          callback(this.err, this.data, this.response);\n          if (this.next) {\n            this.next.prev = null;\n            this.next.check();\n          } else { // q.tail===this\n            q.tail = null;\n          }\n        }\n      }\n    };\n    if (q.tail) {\n      q.tail.next = item;\n    }\n    q.tail = item;\n    return (err, data, response) => {\n      item.fired = 1;\n      item.err = err;\n      item.data = data;\n      item.response = response;\n      item.check();\n    };\n  }\n\n  resume() {\n    if (!this.paused) {\n      return;\n    }\n    this.paused = false;\n\n    let head = this.tail;\n    while (head && head.prev) {\n      head = head.prev;\n    }\n    if (head) {\n      head.check();\n    }\n  }\n}\n\nclass RequestManager {\n  constructor() {\n    this.openedRequests = [];\n  }\n\n  add(req) {\n    this.openedRequests.push(req);\n  }\n\n  remove(req) {\n    const idx = this.openedRequests.indexOf(req);\n    if (idx !== -1) {\n      this.openedRequests.splice(idx, 1);\n    }\n  }\n\n  close() {\n    for (const openedRequest of this.openedRequests) {\n      openedRequest.abort();\n    }\n    this.openedRequests = [];\n  }\n\n  size() {\n    return this.openedRequests.length;\n  }\n}\n\nfunction pad(number) {\n  if (number < 10) {\n    return \"0\" + number;\n  }\n  return number;\n}\n\nfunction toLastModifiedString(date) {\n  return pad(date.getMonth() + 1) +\n    \"/\" + pad(date.getDate()) +\n    \"/\" + date.getFullYear() +\n    \" \" + pad(date.getHours()) +\n    \":\" + pad(date.getMinutes()) +\n    \":\" + pad(date.getSeconds());\n}\n\nconst eventInterfaceTable = {\n  customevent: CustomEvent,\n  errorevent: ErrorEvent,\n  event: Event,\n  events: Event,\n  focusevent: FocusEvent,\n  hashchangeevent: HashChangeEvent,\n  htmlevents: Event,\n  keyboardevent: KeyboardEvent,\n  messageevent: MessageEvent,\n  mouseevent: MouseEvent,\n  mouseevents: MouseEvent,\n  popstateevent: PopStateEvent,\n  progressevent: ProgressEvent,\n  svgevents: Event,\n  touchevent: TouchEvent,\n  uievent: UIEvent,\n  uievents: UIEvent\n};\n\nclass DocumentImpl extends NodeImpl {\n  constructor(args, privateData) {\n    super(args, privateData);\n\n    this._initGlobalEvents();\n\n    this._ownerDocument = this;\n    this.nodeType = NODE_TYPE.DOCUMENT_NODE;\n    if (!privateData.options) {\n      privateData.options = {};\n    }\n    if (!privateData.options.parsingMode) {\n      privateData.options.parsingMode = \"xml\";\n    }\n    if (!privateData.options.encoding) {\n      privateData.options.encoding = \"UTF-8\";\n    }\n    if (!privateData.options.contentType) {\n      privateData.options.contentType = privateData.options.parsingMode === \"xml\" ? \"application/xml\" : \"text/html\";\n    }\n\n    this._parsingMode = privateData.options.parsingMode;\n    this._htmlToDom = new HTMLToDOM(privateData.options.parsingMode);\n\n    this._implementation = DOMImplementation.createImpl([], {\n      ownerDocument: this\n    });\n\n    this._defaultView = privateData.options.defaultView || null;\n    this._global = privateData.options.global;\n    this._documentElement = null;\n    this._ids = Object.create(null);\n    this._attached = true;\n    this._currentScript = null;\n    this._cookieJar = privateData.options.cookieJar;\n    this._parseOptions = privateData.options.parseOptions;\n    if (this._cookieJar === undefined) {\n      this._cookieJar = new CookieJar(null, { looseMode: true });\n    }\n\n    this.contentType = privateData.options.contentType;\n    this._encoding = privateData.options.encoding;\n\n    const urlOption = privateData.options.url === undefined ? \"about:blank\" : privateData.options.url;\n    const parsed = whatwgURL.parseURL(urlOption);\n    if (parsed === null) {\n      throw new TypeError(`Could not parse \"${urlOption}\" as a URL`);\n    }\n\n    this._URL = parsed;\n    this.origin = whatwgURL.serializeURLOrigin(parsed);\n\n    this._location = Location.createImpl([], { relevantDocument: this });\n    this._history = History.createImpl([], {\n      window: this._defaultView,\n      document: this,\n      actAsIfLocationReloadCalled: () => this._location.reload()\n    });\n\n    if (privateData.options.cookie) {\n      const cookies = Array.isArray(privateData.options.cookie) ?\n                      privateData.options.cookie :\n                      [privateData.options.cookie];\n      const document = this;\n\n      cookies.forEach(cookieStr => {\n        document._cookieJar.setCookieSync(cookieStr, document.URL, { ignoreError: true });\n      });\n    }\n\n    this._workingNodeIterators = [];\n    this._workingNodeIteratorsMax = privateData.options.concurrentNodeIterators === undefined ?\n                                    10 :\n                                    Number(privateData.options.concurrentNodeIterators);\n\n    if (isNaN(this._workingNodeIteratorsMax)) {\n      throw new TypeError(\"The 'concurrentNodeIterators' option must be a Number\");\n    }\n\n    if (this._workingNodeIteratorsMax < 0) {\n      throw new RangeError(\"The 'concurrentNodeIterators' option must be a non negative Number\");\n    }\n\n    this._referrer = privateData.options.referrer || \"\";\n    this._lastModified = toLastModifiedString(privateData.options.lastModified || new Date());\n    this._queue = new ResourceQueue(privateData.options.deferClose);\n    this._customResourceLoader = privateData.options.resourceLoader;\n    this._pool = privateData.options.pool;\n    this._agentOptions = privateData.options.agentOptions;\n    this._strictSSL = privateData.options.strictSSL;\n    this._proxy = privateData.options.proxy;\n    this._requestManager = new RequestManager();\n    this.readyState = \"loading\";\n\n    this._lastFocusedElement = null;\n\n    // Each Document in a browsing context can also have a latest entry. This is the entry for that Document\n    // to which the browsing context's session history was most recently traversed. When a Document is created,\n    // it initially has no latest entry.\n    this._latestEntry = null;\n  }\n\n  get compatMode() {\n    return this._parsingMode === \"xml\" || this.doctype ? \"CSS1Compat\" : \"BackCompat\";\n  }\n  get charset() {\n    return this._encoding;\n  }\n  get characterSet() {\n    return this._encoding;\n  }\n  get inputEncoding() {\n    return this._encoding;\n  }\n  get doctype() {\n    for (const childNode of domSymbolTree.childrenIterator(this)) {\n      if (childNode.nodeType === NODE_TYPE.DOCUMENT_TYPE_NODE) {\n        return childNode;\n      }\n    }\n    return null;\n  }\n  get URL() {\n    return whatwgURL.serializeURL(this._URL);\n  }\n  get documentURI() {\n    return whatwgURL.serializeURL(this._URL);\n  }\n  get location() {\n    return this._defaultView ? this._location : null;\n  }\n  get documentElement() {\n    if (this._documentElement) {\n      return this._documentElement;\n    }\n\n    for (const childNode of domSymbolTree.childrenIterator(this)) {\n      if (childNode.nodeType === NODE_TYPE.ELEMENT_NODE) {\n        this._documentElement = childNode;\n        return childNode;\n      }\n    }\n\n    return null;\n  }\n\n  get implementation() {\n    return this._implementation;\n  }\n  set implementation(implementation) {\n    this._implementation = implementation;\n  }\n\n  get defaultView() {\n    return this._defaultView;\n  }\n\n  get currentScript() {\n    return this._currentScript;\n  }\n\n  get activeElement() {\n    if (this._lastFocusedElement) {\n      return this._lastFocusedElement;\n    }\n\n    return this.body;\n  }\n\n  hasFocus() {\n    return Boolean(this._lastFocusedElement);\n  }\n\n  _createElementWithCorrectElementInterface(localName, namespace) {\n    // https://dom.spec.whatwg.org/#concept-element-interface\n\n    if (this._elementBuilders[namespace] && this._elementBuilders[namespace][localName]) {\n      return this._elementBuilders[namespace][localName](this, localName, namespace);\n    } else if (namespace === HTML_NS) {\n      return HTMLUnknownElement.createImpl([], {\n        ownerDocument: this,\n        localName,\n        namespace\n      });\n    } else if (namespace === SVG_NS) {\n      return SVGElement.createImpl([], {\n        ownerDocument: this,\n        localName,\n        namespace\n      });\n    }\n\n    return Element.createImpl([], {\n      ownerDocument: this,\n      localName,\n      namespace\n    });\n  }\n\n  appendChild(/* Node */ arg) {\n    if (this.documentElement && arg.nodeType === NODE_TYPE.ELEMENT_NODE) {\n      throw new DOMException(\"The operation would yield an incorrect node tree.\", \"HierarchyRequestError\");\n    }\n    return super.appendChild(arg);\n  }\n\n  removeChild(/* Node */ arg) {\n    const ret = super.removeChild(arg);\n    if (arg === this._documentElement) {\n      this._documentElement = null;// force a recalculation\n    }\n    return ret;\n  }\n\n  _descendantRemoved(parent, child) {\n    if (child.tagName === \"STYLE\") {\n      const index = this.styleSheets.indexOf(child.sheet);\n      if (index > -1) {\n        this.styleSheets.splice(index, 1);\n      }\n    }\n  }\n\n  write() {\n    let text = \"\";\n    for (let i = 0; i < arguments.length; ++i) {\n      text += String(arguments[i]);\n    }\n\n    if (this._parsingMode === \"xml\") {\n      throw new DOMException(\"Cannot use document.write on XML documents\", \"InvalidStateError\");\n    }\n\n    if (this._writeAfterElement) {\n      // If called from an script element directly (during the first tick),\n      // the new elements are inserted right after that element.\n      const tempDiv = this.createElement(\"div\");\n      tempDiv.innerHTML = text;\n\n      let child = tempDiv.firstChild;\n      let previous = this._writeAfterElement;\n      const parent = this._writeAfterElement.parentNode;\n\n      while (child) {\n        const node = child;\n        child = child.nextSibling;\n\n        node._isMovingDueToDocumentWrite = true; // hack for script execution\n        parent.insertBefore(node, previous.nextSibling);\n        node._isMovingDueToDocumentWrite = false;\n\n        previous = node;\n      }\n    } else if (this.readyState === \"loading\") {\n      // During page loading, document.write appends to the current element\n      // Find the last child that has been added to the document.\n      if (this.lastChild) {\n        let node = this;\n        while (node.lastChild && node.lastChild.nodeType === NODE_TYPE.ELEMENT_NODE) {\n          node = node.lastChild;\n        }\n        node.innerHTML = text;\n      } else {\n        clearChildNodes(this);\n        this._htmlToDom.appendToDocument(text, this);\n      }\n    } else if (text) {\n      clearChildNodes(this);\n      this._htmlToDom.appendToDocument(text, this);\n    }\n  }\n\n  writeln() {\n    this.write(...arguments, \"\\n\");\n  }\n\n  // This is implemented separately for Document (which has a _ids cache) and DocumentFragment (which does not).\n  getElementById(id) {\n    // Return the first element with this ID.\n    return this._ids[id] && this._ids[id].length > 0 ? this._ids[id][0] : null;\n  }\n\n  get referrer() {\n    return this._referrer || \"\";\n  }\n  get lastModified() {\n    return this._lastModified;\n  }\n  get images() {\n    return this.getElementsByTagName(\"IMG\");\n  }\n  get embeds() {\n    return this.getElementsByTagName(\"EMBED\");\n  }\n  get plugins() {\n    return this.embeds;\n  }\n  get links() {\n    return HTMLCollection.createImpl([], {\n      element: this,\n      query: () => domSymbolTree.treeToArray(this, {\n        filter: node => (node._localName === \"a\" || node._localName === \"area\") &&\n                        node.hasAttribute(\"href\") &&\n                        node._namespaceURI === HTML_NS\n      })\n    });\n  }\n  get forms() {\n    return this.getElementsByTagName(\"FORM\");\n  }\n  get scripts() {\n    return this.getElementsByTagName(\"SCRIPT\");\n  }\n  get anchors() {\n    return HTMLCollection.createImpl([], {\n      element: this,\n      query: () => domSymbolTree.treeToArray(this, {\n        filter: node => node._localName === \"a\" &&\n                        node.hasAttribute(\"name\") &&\n                        node._namespaceURI === HTML_NS\n      })\n    });\n  }\n\n  // The applets attribute must return an\n  // HTMLCollection rooted at the Document node,\n  // whose filter matches nothing.\n  // (It exists for historical reasons.)\n  get applets() {\n    return HTMLCollection.createImpl([], {\n      element: this,\n      query: () => []\n    });\n  }\n\n  open() {\n    let child = domSymbolTree.firstChild(this);\n    while (child) {\n      this.removeChild(child);\n      child = domSymbolTree.firstChild(this);\n    }\n    this._documentElement = null;\n    this._modified();\n    return this;\n  }\n  close() {\n    this._queue.resume();\n\n    // Set the readyState to 'complete' once all resources are loaded.\n    // As a side-effect the document's load-event will be dispatched.\n    resourceLoader.enqueue(this, null, function () {\n      this.readyState = \"complete\";\n      const ev = this.createEvent(\"HTMLEvents\");\n      ev.initEvent(\"DOMContentLoaded\", false, false);\n      this.dispatchEvent(ev);\n    })(null, true);\n  }\n\n  getElementsByName(elementName) {\n    return NodeList.createImpl([], {\n      element: this,\n      query: () => domSymbolTree.treeToArray(this, {\n        filter: node => node.getAttribute && node.getAttribute(\"name\") === elementName\n      })\n    });\n  }\n\n  get title() {\n    // TODO SVG\n\n    const titleElement = firstDescendantWithHTMLLocalName(this, \"title\");\n    let value = titleElement !== null ? titleElement.textContent : \"\";\n    value = stripAndCollapseASCIIWhitespace(value);\n    return value;\n  }\n\n  set title(val) {\n    // TODO SVG\n\n    const titleElement = firstDescendantWithHTMLLocalName(this, \"title\");\n    const headElement = this.head;\n\n    if (titleElement === null && headElement === null) {\n      return;\n    }\n\n    let element;\n    if (titleElement !== null) {\n      element = titleElement;\n    } else {\n      element = this.createElement(\"title\");\n      headElement.appendChild(element);\n    }\n\n    element.textContent = val;\n  }\n\n  get dir() {\n    return this.documentElement ? this.documentElement.dir : \"\";\n  }\n  set dir(value) {\n    if (this.documentElement) {\n      this.documentElement.dir = value;\n    }\n  }\n\n  get head() {\n    return this.documentElement ? firstChildWithHTMLLocalName(this.documentElement, \"head\") : null;\n  }\n\n  get body() {\n    const { documentElement } = this;\n    if (!documentElement || documentElement._localName !== \"html\" ||\n        documentElement._namespaceURI !== HTML_NS) {\n      return null;\n    }\n\n    return firstChildWithHTMLLocalNames(this.documentElement, new Set([\"body\", \"frameset\"]));\n  }\n\n  set body(value) {\n    if (value === null ||\n        value._namespaceURI !== HTML_NS ||\n        (value._localName !== \"body\" && value._localName !== \"frameset\")) {\n      throw new DOMException(\"Cannot set the body to null or a non-body/frameset element\", \"HierarchyRequestError\");\n    }\n\n    const bodyElement = this.body;\n    if (value === bodyElement) {\n      return;\n    }\n\n    if (bodyElement !== null) {\n      bodyElement.parentNode.replaceChild(value, bodyElement);\n      return;\n    }\n\n    const { documentElement } = this;\n    if (documentElement === null) {\n      throw new DOMException(\"Cannot set the body when there is no document element\", \"HierarchyRequestError\");\n    }\n\n    documentElement.appendChild(value);\n  }\n\n  _runPreRemovingSteps(oldNode) {\n    for (const activeNodeIterator of this._workingNodeIterators) {\n      activeNodeIterator._preRemovingSteps(oldNode);\n    }\n  }\n\n  createEvent(type) {\n    const typeLower = type.toLowerCase();\n    const eventWrapper = eventInterfaceTable[typeLower] || null;\n\n    if (!eventWrapper) {\n      throw new DOMException(\"The provided event type (\\\"\" + type + \"\\\") is invalid\", \"NotSupportedError\");\n    }\n\n    const impl = eventWrapper.createImpl([\"\"]);\n    impl._initializedFlag = false;\n    return impl;\n  }\n\n  createProcessingInstruction(target, data) {\n    validateName(target);\n\n    if (data.includes(\"?>\")) {\n      throw new DOMException(\"Processing instruction data cannot contain the string \\\"?>\\\"\", \"InvalidCharacterError\");\n    }\n\n    return ProcessingInstruction.createImpl([], {\n      ownerDocument: this,\n      target,\n      data\n    });\n  }\n\n  // https://dom.spec.whatwg.org/#dom-document-createcdatasection\n  createCDATASection(data) {\n    if (this._parsingMode === \"html\") {\n      throw new DOMException(\"Cannot create CDATA sections in HTML documents\", \"NotSupportedError\");\n    }\n\n    if (data.includes(\"]]>\")) {\n      throw new DOMException(\"CDATA section data cannot contain the string \\\"]]>\\\"\", \"InvalidCharacterError\");\n    }\n\n    return CDATASection.createImpl([], {\n      ownerDocument: this,\n      data\n    });\n  }\n\n  createTextNode(data) {\n    return Text.createImpl([], {\n      ownerDocument: this,\n      data\n    });\n  }\n\n  createComment(data) {\n    return Comment.createImpl([], {\n      ownerDocument: this,\n      data\n    });\n  }\n\n  createElement(localName) {\n    validateName(localName);\n    if (this._parsingMode === \"html\") {\n      localName = asciiLowercase(localName);\n    }\n\n    const namespace = this._parsingMode === \"html\" || this.contentType === \"application/xhtml+xml\" ? HTML_NS : null;\n\n    return this._createElementWithCorrectElementInterface(localName, namespace);\n  }\n\n  createElementNS(namespace, qualifiedName) {\n    namespace = namespace !== null ? String(namespace) : namespace;\n\n    const extracted = validateAndExtract(namespace, qualifiedName);\n\n    const element = this._createElementWithCorrectElementInterface(extracted.localName, extracted.namespace);\n    element._prefix = extracted.prefix;\n\n    return element;\n  }\n\n  createDocumentFragment() {\n    return DocumentFragment.createImpl([], { ownerDocument: this });\n  }\n\n  createAttribute(localName) {\n    validateName(localName);\n\n    if (this._parsingMode === \"html\") {\n      localName = asciiLowercase(localName);\n    }\n\n    return generatedAttr.createImpl([], { localName });\n  }\n\n  createAttributeNS(namespace, name) {\n    if (namespace === undefined) {\n      namespace = null;\n    }\n    namespace = namespace !== null ? String(namespace) : namespace;\n\n    const extracted = validateAndExtract(namespace, name);\n    return generatedAttr.createImpl([], {\n      namespace: extracted.namespace,\n      namespacePrefix: extracted.prefix,\n      localName: extracted.localName\n    });\n  }\n\n  // TODO: Add callback interface support to `webidl2js`\n  createTreeWalker(root, whatToShow, filter) {\n    return TreeWalker.createImpl([], { root, whatToShow, filter });\n  }\n\n  createNodeIterator(root, whatToShow, filter) {\n    const nodeIterator = NodeIterator.createImpl([], { root, whatToShow, filter });\n\n    this._workingNodeIterators.push(nodeIterator);\n    while (this._workingNodeIterators.length > this._workingNodeIteratorsMax) {\n      const toInactivate = this._workingNodeIterators.shift();\n      toInactivate._working = false;\n    }\n\n    return nodeIterator;\n  }\n\n  importNode(node, deep) {\n    if (node.nodeType === NODE_TYPE.DOCUMENT_NODE) {\n      throw new DOMException(\"Cannot import a document node\", \"NotSupportedError\");\n    }\n\n    return clone(node, this, deep);\n  }\n\n  adoptNode(node) {\n    if (node.nodeType === NODE_TYPE.DOCUMENT_NODE) {\n      throw new DOMException(\"Cannot adopt a document node\", \"NotSupportedError\");\n    }\n    // TODO: Determine correct way to detect a shadow root\n    // See also https://github.com/w3c/webcomponents/issues/182\n\n    if (node.parentNode) {\n      node.parentNode.removeChild(node);\n    }\n    node._ownerDocument = this;\n    for (const descendant of domSymbolTree.treeIterator(node)) {\n      descendant._ownerDocument = this;\n    }\n\n    return node;\n  }\n\n  get cookie() {\n    return this._cookieJar.getCookieStringSync(this.URL, { http: false });\n  }\n  set cookie(cookieStr) {\n    cookieStr = String(cookieStr);\n    this._cookieJar.setCookieSync(cookieStr, this.URL, {\n      http: false,\n      ignoreError: true\n    });\n  }\n\n  // The clear(), captureEvents(), and releaseEvents() methods must do nothing\n  clear() {}\n\n  captureEvents() {}\n\n  releaseEvents() {}\n\n  get styleSheets() {\n    if (!this._styleSheets) {\n      this._styleSheets = new StyleSheetList();\n    }\n\n    // TODO: each style and link element should register its sheet on creation\n    // and remove it on removal.\n    return this._styleSheets;\n  }\n\n  get hidden() {\n    if (this._defaultView && this._defaultView._pretendToBeVisual) {\n      return false;\n    }\n\n    return true;\n  }\n\n  get visibilityState() {\n    if (this._defaultView && this._defaultView._pretendToBeVisual) {\n      return \"visible\";\n    }\n\n    return \"prerender\";\n  }\n}\n\neventAccessors.createEventAccessor(DocumentImpl.prototype, \"readystatechange\");\nmixin(DocumentImpl.prototype, GlobalEventHandlersImpl.prototype);\nmixin(DocumentImpl.prototype, NonElementParentNodeImpl.prototype);\nmixin(DocumentImpl.prototype, ParentNodeImpl.prototype);\n\nDocumentImpl.prototype._elementBuilders = Object.create(null);\n\nDocumentImpl.prototype.getElementsByTagName = memoizeQuery(function (qualifiedName) {\n  return listOfElementsWithQualifiedName(qualifiedName, this);\n});\n\nDocumentImpl.prototype.getElementsByTagNameNS = memoizeQuery(function (namespace, localName) {\n  return listOfElementsWithNamespaceAndLocalName(namespace, localName, this);\n});\n\nDocumentImpl.prototype.getElementsByClassName = memoizeQuery(function getElementsByClassName(classNames) {\n  return listOfElementsWithClassNames(classNames, this);\n});\n\nmodule.exports = {\n  implementation: DocumentImpl\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}