{"ast":null,"code":"\"use strict\";\n\nconst vm = require(\"vm\");\nconst idlUtils = require(\"../living/generated/utils\");\nexports.availableDocumentFeatures = [\"FetchExternalResources\", \"SkipExternalResources\"];\nexports.defaultDocumentFeatures = {\n  FetchExternalResources: [\"script\", \"link\"],\n  // omitted by default: \"frame\"\n  SkipExternalResources: false\n};\nexports.applyDocumentFeatures = function (documentImpl) {\n  let features = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  for (let i = 0; i < exports.availableDocumentFeatures.length; ++i) {\n    const featureName = exports.availableDocumentFeatures[i];\n    let featureSource;\n    if (features[featureName] !== undefined) {\n      featureSource = features[featureName];\n      // We have to check the lowercase version also because the Document feature\n      // methods convert everything to lowercase.\n    } else if (typeof features[featureName.toLowerCase()] !== \"undefined\") {\n      featureSource = features[featureName.toLowerCase()];\n    } else if (exports.defaultDocumentFeatures[featureName]) {\n      featureSource = exports.defaultDocumentFeatures[featureName];\n    } else {\n      continue;\n    }\n    const implImpl = documentImpl._implementation;\n    implImpl._removeFeature(featureName);\n    if (featureSource !== undefined) {\n      if (Array.isArray(featureSource)) {\n        for (let j = 0; j < featureSource.length; ++j) {\n          implImpl._addFeature(featureName, featureSource[j]);\n        }\n      } else {\n        implImpl._addFeature(featureName, featureSource);\n      }\n    }\n  }\n};\nexports.contextifyWindow = window => {\n  if (vm.isContext(window)) {\n    return;\n  }\n  vm.createContext(window);\n  const documentImpl = idlUtils.implForWrapper(window._document);\n  documentImpl._defaultView = window._globalProxy = vm.runInContext(\"this\", window);\n};","map":{"version":3,"names":["vm","require","idlUtils","exports","availableDocumentFeatures","defaultDocumentFeatures","FetchExternalResources","SkipExternalResources","applyDocumentFeatures","documentImpl","features","arguments","length","undefined","i","featureName","featureSource","toLowerCase","implImpl","_implementation","_removeFeature","Array","isArray","j","_addFeature","contextifyWindow","window","isContext","createContext","implForWrapper","_document","_defaultView","_globalProxy","runInContext"],"sources":["G:/scientificKeyboard/keyboard/node_modules/mathjax-node/node_modules/jsdom/lib/jsdom/browser/documentfeatures.js"],"sourcesContent":["\"use strict\";\nconst vm = require(\"vm\");\nconst idlUtils = require(\"../living/generated/utils\");\n\nexports.availableDocumentFeatures = [\n  \"FetchExternalResources\",\n  \"SkipExternalResources\"\n];\n\nexports.defaultDocumentFeatures = {\n  FetchExternalResources: [\"script\", \"link\"], // omitted by default: \"frame\"\n  SkipExternalResources: false\n};\n\nexports.applyDocumentFeatures = (documentImpl, features = {}) => {\n  for (let i = 0; i < exports.availableDocumentFeatures.length; ++i) {\n    const featureName = exports.availableDocumentFeatures[i];\n    let featureSource;\n\n    if (features[featureName] !== undefined) {\n      featureSource = features[featureName];\n      // We have to check the lowercase version also because the Document feature\n      // methods convert everything to lowercase.\n    } else if (typeof features[featureName.toLowerCase()] !== \"undefined\") {\n      featureSource = features[featureName.toLowerCase()];\n    } else if (exports.defaultDocumentFeatures[featureName]) {\n      featureSource = exports.defaultDocumentFeatures[featureName];\n    } else {\n      continue;\n    }\n\n    const implImpl = documentImpl._implementation;\n    implImpl._removeFeature(featureName);\n\n    if (featureSource !== undefined) {\n      if (Array.isArray(featureSource)) {\n        for (let j = 0; j < featureSource.length; ++j) {\n          implImpl._addFeature(featureName, featureSource[j]);\n        }\n      } else {\n        implImpl._addFeature(featureName, featureSource);\n      }\n    }\n  }\n};\n\nexports.contextifyWindow = window => {\n  if (vm.isContext(window)) {\n    return;\n  }\n\n  vm.createContext(window);\n  const documentImpl = idlUtils.implForWrapper(window._document);\n  documentImpl._defaultView = window._globalProxy = vm.runInContext(\"this\", window);\n};\n"],"mappings":"AAAA,YAAY;;AACZ,MAAMA,EAAE,GAAGC,OAAO,CAAC,IAAI,CAAC;AACxB,MAAMC,QAAQ,GAAGD,OAAO,CAAC,2BAA2B,CAAC;AAErDE,OAAO,CAACC,yBAAyB,GAAG,CAClC,wBAAwB,EACxB,uBAAuB,CACxB;AAEDD,OAAO,CAACE,uBAAuB,GAAG;EAChCC,sBAAsB,EAAE,CAAC,QAAQ,EAAE,MAAM,CAAC;EAAE;EAC5CC,qBAAqB,EAAE;AACzB,CAAC;AAEDJ,OAAO,CAACK,qBAAqB,GAAG,UAACC,YAAY,EAAoB;EAAA,IAAlBC,QAAQ,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAG,CAAC,CAAC;EAC1D,KAAK,IAAIG,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGX,OAAO,CAACC,yBAAyB,CAACQ,MAAM,EAAE,EAAEE,CAAC,EAAE;IACjE,MAAMC,WAAW,GAAGZ,OAAO,CAACC,yBAAyB,CAACU,CAAC,CAAC;IACxD,IAAIE,aAAa;IAEjB,IAAIN,QAAQ,CAACK,WAAW,CAAC,KAAKF,SAAS,EAAE;MACvCG,aAAa,GAAGN,QAAQ,CAACK,WAAW,CAAC;MACrC;MACA;IACF,CAAC,MAAM,IAAI,OAAOL,QAAQ,CAACK,WAAW,CAACE,WAAW,CAAC,CAAC,CAAC,KAAK,WAAW,EAAE;MACrED,aAAa,GAAGN,QAAQ,CAACK,WAAW,CAACE,WAAW,CAAC,CAAC,CAAC;IACrD,CAAC,MAAM,IAAId,OAAO,CAACE,uBAAuB,CAACU,WAAW,CAAC,EAAE;MACvDC,aAAa,GAAGb,OAAO,CAACE,uBAAuB,CAACU,WAAW,CAAC;IAC9D,CAAC,MAAM;MACL;IACF;IAEA,MAAMG,QAAQ,GAAGT,YAAY,CAACU,eAAe;IAC7CD,QAAQ,CAACE,cAAc,CAACL,WAAW,CAAC;IAEpC,IAAIC,aAAa,KAAKH,SAAS,EAAE;MAC/B,IAAIQ,KAAK,CAACC,OAAO,CAACN,aAAa,CAAC,EAAE;QAChC,KAAK,IAAIO,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGP,aAAa,CAACJ,MAAM,EAAE,EAAEW,CAAC,EAAE;UAC7CL,QAAQ,CAACM,WAAW,CAACT,WAAW,EAAEC,aAAa,CAACO,CAAC,CAAC,CAAC;QACrD;MACF,CAAC,MAAM;QACLL,QAAQ,CAACM,WAAW,CAACT,WAAW,EAAEC,aAAa,CAAC;MAClD;IACF;EACF;AACF,CAAC;AAEDb,OAAO,CAACsB,gBAAgB,GAAGC,MAAM,IAAI;EACnC,IAAI1B,EAAE,CAAC2B,SAAS,CAACD,MAAM,CAAC,EAAE;IACxB;EACF;EAEA1B,EAAE,CAAC4B,aAAa,CAACF,MAAM,CAAC;EACxB,MAAMjB,YAAY,GAAGP,QAAQ,CAAC2B,cAAc,CAACH,MAAM,CAACI,SAAS,CAAC;EAC9DrB,YAAY,CAACsB,YAAY,GAAGL,MAAM,CAACM,YAAY,GAAGhC,EAAE,CAACiC,YAAY,CAAC,MAAM,EAAEP,MAAM,CAAC;AACnF,CAAC"},"metadata":{},"sourceType":"script","externalDependencies":[]}